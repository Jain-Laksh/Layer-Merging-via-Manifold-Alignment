Bayesian Optimization Script Started
Runtime output will be saved to: ./optimization_run/optimization_run_2025-11-04_21-37-31.log
Arguments: Namespace(model_path='meta-llama/Meta-Llama-3-8B', alphas_file='./fusion_alphas.json', num_layer=13, output_dir='./optimization_run', data_dir='./data')
Loading base model from meta-llama/Meta-Llama-3-8B...
Loading tokenizer...
Loading 'anatomy' dev and test data...
Globals loaded successfully.

Probing with known alphas from ./fusion_alphas.json...
Successfully added starting alphas as first point to test.

============================================================
STARTING BAYESIAN OPTIMIZATION
This will run the 'fuse-then-evaluate' loop multiple times.
Each 'step' (e.g., 1/25) will take a few minutes.
============================================================
|   iter    |  target   |  alpha_0  |  alpha_1  |  alpha_2  |  alpha_3  |  alpha_4  |  alpha_5  |  alpha_6  |  alpha_7  |  alpha_8  |  alpha_9  | alpha_10  | alpha_11  | alpha_12  |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
| [39m1        [39m | [39m0.6592592[39m | [39m0.6257765[39m | [39m0.6270365[39m | [39m0.6218680[39m | [39m0.6279836[39m | [39m0.6236575[39m | [39m0.6261533[39m | [39m0.6230820[39m | [39m0.6222846[39m | [39m0.6240776[39m | [39m0.6122476[39m | [39m0.6201869[39m | [39m0.6139920[39m | [39m0.6216273[39m |
| [35m2        [39m | [35m0.6740740[39m | [35m0.4668088[39m | [35m0.5881297[39m | [35m0.3000457[39m | [35m0.4209330[39m | [35m0.3587023[39m | [35m0.3369354[39m | [35m0.3745040[39m | [35m0.4382242[39m | [35m0.4587069[39m | [35m0.5155266[39m | [35m0.4676778[39m | [35m0.5740878[39m | [35m0.3817808[39m |
| [39m3        [39m | [39m0.6592592[39m | [39m0.6512469[39m | [39m0.3109550[39m | [39m0.5681870[39m | [39m0.4669219[39m | [39m0.5234759[39m | [39m0.3561547[39m | [39m0.3792405[39m | [39m0.6202978[39m | [39m0.6873046[39m | [39m0.4253696[39m | [39m0.5769290[39m | [39m0.6505556[39m | [39m0.6578426[39m |
| [39m4        [39m | [39m0.6740740[39m | [39m0.3340176[39m | [39m0.3156219[39m | [39m0.3679321[39m | [39m0.6512570[39m | [39m0.3393387[39m | [39m0.4684430[39m | [39m0.6831558[39m | [39m0.5132661[39m | [39m0.5767508[39m | [39m0.4262062[39m | [39m0.5746003[39m | [39m0.6338502[39m | [39m0.3073153[39m |
| [39m5        [39m | [39m0.6444444[39m | [39m0.6000577[39m | [39m0.6955444[39m | [39m0.5992662[39m | [39m0.4121775[39m | [39m0.6157117[39m | [39m0.3412904[39m | [39m0.4791574[39m | [39m0.6634382[39m | [39m0.4174456[39m | [39m0.4151101[39m | [39m0.3520114[39m | [39m0.3077467[39m | [39m0.5715342[39m |
| [39m6        [39m | [39m0.6740740[39m | [39m0.3846512[39m | [39m0.4062186[39m | [39m0.4966292[39m | [39m0.3213450[39m | [39m0.5296470[39m | [39m0.3586914[39m | [39m0.5357222[39m | [39m0.5799033[39m | [39m0.3409337[39m | [39m0.4656223[39m | [39m0.5777600[39m | [39m0.4656717[39m | [39m0.3199813[39m |
| [39m7        [39m | [39m0.6592592[39m | [39m0.6613607[39m | [39m0.4818650[39m | [39m0.5873441[39m | [39m0.3977504[39m | [39m0.5564156[39m | [39m0.5420148[39m | [39m0.4710454[39m | [39m0.5137640[39m | [39m0.3222571[39m | [39m0.3050564[39m | [39m0.3462190[39m | [39m0.6039000[39m | [39m0.6396723[39m |
| [39m8        [39m | [39m0.6518518[39m | [39m0.5657863[39m | [39m0.6214393[39m | [39m0.5015777[39m | [39m0.4427973[39m | [39m0.3076565[39m | [39m0.5012938[39m | [39m0.5415875[39m | [39m0.6060000[39m | [39m0.4478862[39m | [39m0.3478863[39m | [39m0.3469992[39m | [39m0.5478303[39m | [39m0.6164328[39m |
| [39m9        [39m | [39m0.6740740[39m | [39m0.3      [39m | [39m0.3186941[39m | [39m0.3      [39m | [39m0.4041112[39m | [39m0.3983976[39m | [39m0.3463137[39m | [39m0.4802889[39m | [39m0.3546888[39m | [39m0.3631411[39m | [39m0.5554258[39m | [39m0.6575540[39m | [39m0.6439235[39m | [39m0.3      [39m |
| [39m10       [39m | [39m0.6740740[39m | [39m0.3      [39m | [39m0.4276716[39m | [39m0.3      [39m | [39m0.3      [39m | [39m0.3      [39m | [39m0.3      [39m | [39m0.5752836[39m | [39m0.5567468[39m | [39m0.6540390[39m | [39m0.6936834[39m | [39m0.7      [39m | [39m0.4479194[39m | [39m0.3      [39m |
| [39m11       [39m | [39m0.6592592[39m | [39m0.4810052[39m | [39m0.6377025[39m | [39m0.3027264[39m | [39m0.6320094[39m | [39m0.5550816[39m | [39m0.5993673[39m | [39m0.4047816[39m | [39m0.3385598[39m | [39m0.4392370[39m | [39m0.5774304[39m | [39m0.3071160[39m | [39m0.4605159[39m | [39m0.6403436[39m |
| [39m12       [39m | [39m0.6592592[39m | [39m0.5860050[39m | [39m0.3541252[39m | [39m0.3867645[39m | [39m0.4611177[39m | [39m0.5389507[39m | [39m0.3345589[39m | [39m0.4753549[39m | [39m0.5787340[39m | [39m0.6639097[39m | [39m0.3568317[39m | [39m0.3348712[39m | [39m0.5335022[39m | [39m0.6306212[39m |
| [39m13       [39m | [39m0.6740740[39m | [39m0.3      [39m | [39m0.5947359[39m | [39m0.3      [39m | [39m0.3      [39m | [39m0.4787499[39m | [39m0.3      [39m | [39m0.5930925[39m | [39m0.3179736[39m | [39m0.6371672[39m | [39m0.3      [39m | [39m0.7      [39m | [39m0.7      [39m | [39m0.3      [39m |
| [39m14       [39m | [39m0.6740740[39m | [39m0.3064627[39m | [39m0.6819046[39m | [39m0.6414167[39m | [39m0.3989689[39m | [39m0.4555947[39m | [39m0.5153384[39m | [39m0.6688414[39m | [39m0.6662517[39m | [39m0.6592090[39m | [39m0.5828877[39m | [39m0.4090525[39m | [39m0.3732781[39m | [39m0.4264062[39m |
| [39m15       [39m | [39m0.6518518[39m | [39m0.4863633[39m | [39m0.5529631[39m | [39m0.5265687[39m | [39m0.5229386[39m | [39m0.3942704[39m | [39m0.5668462[39m | [39m0.6441133[39m | [39m0.5724279[39m | [39m0.4599676[39m | [39m0.5765630[39m | [39m0.3532108[39m | [39m0.3117562[39m | [39m0.5006010[39m |
| [39m16       [39m | [39m0.6740740[39m | [39m0.3      [39m | [39m0.5984579[39m | [39m0.5925428[39m | [39m0.3      [39m | [39m0.4500093[39m | [39m0.3959608[39m | [39m0.6605843[39m | [39m0.5116530[39m | [39m0.7      [39m | [39m0.6610695[39m | [39m0.5335714[39m | [39m0.7      [39m | [39m0.3      [39m |
| [39m17       [39m | [39m0.6740740[39m | [39m0.4624228[39m | [39m0.6202944[39m | [39m0.6833185[39m | [39m0.3504753[39m | [39m0.3743305[39m | [39m0.4471522[39m | [39m0.4219293[39m | [39m0.5665517[39m | [39m0.6037771[39m | [39m0.3223809[39m | [39m0.6853706[39m | [39m0.3864065[39m | [39m0.3408071[39m |
| [39m18       [39m | [39m0.6740740[39m | [39m0.5397590[39m | [39m0.3548144[39m | [39m0.5964085[39m | [39m0.4442921[39m | [39m0.3395275[39m | [39m0.4723842[39m | [39m0.3832648[39m | [39m0.5031324[39m | [39m0.4584799[39m | [39m0.5722892[39m | [39m0.3872839[39m | [39m0.3255518[39m | [39m0.3208702[39m |
| [39m19       [39m | [39m0.6518518[39m | [39m0.5938608[39m | [39m0.6073084[39m | [39m0.6514849[39m | [39m0.4034940[39m | [39m0.3462015[39m | [39m0.6744817[39m | [39m0.5454974[39m | [39m0.6684213[39m | [39m0.3775386[39m | [39m0.4972198[39m | [39m0.6957299[39m | [39m0.3854126[39m | [39m0.6063718[39m |
| [39m20       [39m | [39m0.6740740[39m | [39m0.5150906[39m | [39m0.6331453[39m | [39m0.4648554[39m | [39m0.6885402[39m | [39m0.5751525[39m | [39m0.5938221[39m | [39m0.3852894[39m | [39m0.6738072[39m | [39m0.6689608[39m | [39m0.6378730[39m | [39m0.6700466[39m | [39m0.3619947[39m | [39m0.3709440[39m |
| [39m21       [39m | [39m0.6740740[39m | [39m0.3      [39m | [39m0.4307020[39m | [39m0.5862280[39m | [39m0.4525029[39m | [39m0.4585212[39m | [39m0.4862156[39m | [39m0.3      [39m | [39m0.3752410[39m | [39m0.7      [39m | [39m0.5816354[39m | [39m0.6297642[39m | [39m0.3759255[39m | [39m0.3      [39m |
| [39m22       [39m | [39m0.6740740[39m | [39m0.6913301[39m | [39m0.4185490[39m | [39m0.5006913[39m | [39m0.3018877[39m | [39m0.3664506[39m | [39m0.6749220[39m | [39m0.3237985[39m | [39m0.3568784[39m | [39m0.6586653[39m | [39m0.5870246[39m | [39m0.5951487[39m | [39m0.6298237[39m | [39m0.3843501[39m |
| [39m23       [39m | [39m0.6740740[39m | [39m0.3      [39m | [39m0.5652568[39m | [39m0.3431258[39m | [39m0.3      [39m | [39m0.4025108[39m | [39m0.6473999[39m | [39m0.3      [39m | [39m0.7      [39m | [39m0.7      [39m | [39m0.4872289[39m | [39m0.5944464[39m | [39m0.5815407[39m | [39m0.3      [39m |
| [39m24       [39m | [39m0.6740740[39m | [39m0.3      [39m | [39m0.3      [39m | [39m0.6604460[39m | [39m0.3      [39m | [39m0.3      [39m | [39m0.4062729[39m | [39m0.3      [39m | [39m0.3201693[39m | [39m0.4670698[39m | [39m0.3      [39m | [39m0.3872030[39m | [39m0.6400589[39m | [39m0.3      [39m |
| [39m25       [39m | [39m0.6740740[39m | [39m0.3      [39m | [39m0.7      [39m | [39m0.6210588[39m | [39m0.6660048[39m | [39m0.3      [39m | [39m0.3      [39m | [39m0.3278969[39m | [39m0.7      [39m | [39m0.7      [39m | [39m0.7      [39m | [39m0.7      [39m | [39m0.5016369[39m | [39m0.3      [39m |
| [39m26       [39m | [39m0.6740740[39m | [39m0.6210994[39m | [39m0.3      [39m | [39m0.3      [39m | [39m0.3      [39m | [39m0.3      [39m | [39m0.3649334[39m | [39m0.3      [39m | [39m0.3      [39m | [39m0.5035005[39m | [39m0.3      [39m | [39m0.7      [39m | [39m0.3378408[39m | [39m0.3      [39m |
| [39m27       [39m | [39m0.6518518[39m | [39m0.6723833[39m | [39m0.3579453[39m | [39m0.3153909[39m | [39m0.6867419[39m | [39m0.4575134[39m | [39m0.6213203[39m | [39m0.5701488[39m | [39m0.5402830[39m | [39m0.4472310[39m | [39m0.4094908[39m | [39m0.4130646[39m | [39m0.5352974[39m | [39m0.6935081[39m |
| [39m28       [39m | [39m0.6740740[39m | [39m0.4544932[39m | [39m0.5931413[39m | [39m0.3030395[39m | [39m0.4198095[39m | [39m0.3690527[39m | [39m0.3336643[39m | [39m0.3645933[39m | [39m0.4298022[39m | [39m0.5000264[39m | [39m0.5006007[39m | [39m0.4684661[39m | [39m0.5673361[39m | [39m0.3678931[39m |
| [39m29       [39m | [39m0.6740740[39m | [39m0.3      [39m | [39m0.7      [39m | [39m0.7      [39m | [39m0.3      [39m | [39m0.7      [39m | [39m0.7      [39m | [39m0.6145033[39m | [39m0.7      [39m | [39m0.7      [39m | [39m0.7      [39m | [39m0.7      [39m | [39m0.3      [39m | [39m0.3      [39m |
| [39m30       [39m | [39m0.6740740[39m | [39m0.7      [39m | [39m0.3      [39m | [39m0.4069008[39m | [39m0.3      [39m | [39m0.3      [39m | [39m0.3      [39m | [39m0.3      [39m | [39m0.3      [39m | [39m0.3      [39m | [39m0.7      [39m | [39m0.3      [39m | [39m0.7      [39m | [39m0.3      [39m |
| [39m31       [39m | [39m0.6592592[39m | [39m0.5944548[39m | [39m0.3828319[39m | [39m0.5650104[39m | [39m0.3421300[39m | [39m0.3552849[39m | [39m0.4635305[39m | [39m0.3295134[39m | [39m0.6827100[39m | [39m0.6170172[39m | [39m0.4957000[39m | [39m0.3412538[39m | [39m0.4461962[39m | [39m0.5463156[39m |
=====================================================================================================================================================================================

============================================================
OPTIMIZATION FINISHED
============================================================
Best accuracy found:
{'target': np.float64(0.674074074074074), 'params': {'alpha_0': np.float64(0.4668088018810296), 'alpha_1': np.float64(0.5881297973768632), 'alpha_2': np.float64(0.30004574992693794), 'alpha_3': np.float64(0.4209330290527359), 'alpha_4': np.float64(0.3587023563268452), 'alpha_5': np.float64(0.3369354379075191), 'alpha_6': np.float64(0.3745040845510683), 'alpha_7': np.float64(0.4382242908172191), 'alpha_8': np.float64(0.458706989692268), 'alpha_9': np.float64(0.5155266936013427), 'alpha_10': np.float64(0.4676778057613179), 'alpha_11': np.float64(0.5740878001587038), 'alpha_12': np.float64(0.38178089989260694)}}

Best alpha values saved to ./optimization_run/optimized_alphas.json
You can now use this file with your 'custom_alpha_load_eval.py' script.
